# 3D模型打印系统产品设计文档

## 1. 产品概述

### 1.1 产品定位
一个基于Web的用户自定义3D模型生成与打印平台，支持通过文本描述或照片生成3D模型，并提供风格化处理和直接打印功能。

### 1.2 核心价值
- 降低3D建模门槛，让普通用户无需专业技能即可创建3D模型
- 提供AI辅助的模型生成和风格化能力
- 打通从创意到实物的完整链路

### 1.3 目标用户
- 3D打印爱好者
- 个性化定制需求用户
- 创意设计师
- 教育和研发机构

## 2. 功能模块划分

### 2.1 P0 功能模块（核心MVP，2天内完成）

#### 2.1.1 基础Web界面
**功能描述：**
- 提供简洁的单页面应用（SPA）
- 包含文本输入框和照片上传区域
- 显示生成的3D模型预览
- 提供模型下载功能

**技术实现方案：**
- 前端：React + Three.js (3D渲染)
- UI框架：Tailwind CSS
- 文件上传：简单的form upload

**验收标准：**
- [ ] 用户可以在Web页面输入文本描述（至少50字符）
- [ ] 用户可以上传照片（支持JPG/PNG，最大10MB）
- [ ] 页面响应时间 < 2秒（不含模型生成）
- [ ] 支持Chrome、Firefox、Safari最新版本
- [ ] 移动端基础适配（可浏览但不强制优化）

#### 2.1.2 文本转3D模型（基础版）
**功能描述：**
- 接受用户文本描述
- 调用开源/免费API生成基础3D模型
- 返回可预览的3D文件（STL/OBJ格式）

**技术实现方案：**
- 使用 meshy.ai 的文本转3D API
- 后端：Python + FastAPI
- 模型格式转换：trimesh库

**验收标准：**
- [ ] 用户输入"一个圆形的杯子"能生成对应3D模型
- [ ] 生成时间 < 60秒
- [ ] 模型文件可正常下载（STL格式）
- [ ] 模型在Three.js中可正常预览
- [ ] 至少支持10种基础物体描述（杯子、碗、盒子、球体等）

#### 2.1.3 模型文件导出
**功能描述：**
- 将生成的3D模型导出为STL格式
- 支持直接下载到本地

**技术实现方案：**
- 使用trimesh进行格式转换和验证
- 前端通过Blob下载

**验收标准：**
- [ ] 导出的STL文件可被主流切片软件识别（Cura、PrusaSlicer）
- [ ] 文件大小 < 50MB
- [ ] 模型无明显破面或错误
- [ ] 下载速度 < 5秒

#### 2.1.4 打印机适配层
**功能描述：**
- 对接拓竹H2D打印机
- 生成适配拓竹H2D的G-code文件
- 提供基础打印参数预设

**技术实现方案：**
- 集成CuraEngine命令行工具
- 提供拓竹H2D机型配置文件
- 后端生成G-code

**验收标准：**
- [ ] 支持拓竹H2D机型配置
- [ ] 生成的G-code可被拓竹H2D打印机识别
- [ ] 提供基础打印参数调整（层高、填充率）
- [ ] G-code生成时间 < 30秒

---

### 2.2 P1 功能模块（重要功能，MVP+）

#### 2.2.1 照片转3D模型
**功能描述：**
- 用户上传单张或多张照片
- 系统生成对应的3D模型
- 支持基础的深度估计和模型重建

**技术实现方案：**
- 使用 meshy.ai 的图片转3D API
- 后端集成 meshy.ai SDK

**验收标准：**
- [ ] 单张照片生成时间 < 120秒
- [ ] 生成的模型与照片主体形状相似度 > 70%
- [ ] 支持人物、物体、建筑等常见类型
- [ ] 模型可正常导出为STL格式

#### 2.2.2 照片风格化（转动漫风格）
**功能描述：**
- 在照片转3D之前，对照片进行风格化处理
- 支持转为动漫、卡通等风格
- 风格化后的照片可用于生成3D模型

**技术实现方案：**
- 使用AnimeGAN或类似模型
- 提供2-3种预设风格
- 前置处理，不影响3D生成流程

**验收标准：**
- [ ] 风格化处理时间 < 30秒
- [ ] 至少支持3种风格（动漫、卡通、素描）
- [ ] 风格化后图片分辨率保持原始的80%以上
- [ ] 用户可预览风格化效果后再进行3D转换

#### 2.2.3 3D模型在线预览优化
**功能描述：**
- 支持360度旋转查看
- 支持缩放和平移
- 显示模型基础信息（尺寸、面数）

**技术实现方案：**
- Three.js + OrbitControls
- 添加光照和材质优化
- 显示模型统计信息

**验收标准：**
- [ ] 支持鼠标拖拽旋转
- [ ] 支持滚轮缩放
- [ ] 显示模型尺寸（mm）
- [ ] 显示三角面数量
- [ ] 预览加载时间 < 3秒

---

### 2.3 P2 功能模块（增强功能）

#### 2.3.1 用户账户系统
**功能描述：**
- 用户注册、登录
- 保存历史生成记录
- 管理已创建的模型

**技术实现方案：**
- JWT认证
- 数据库：PostgreSQL或SQLite
- 存储：本地文件系统或对象存储

**验收标准：**
- [ ] 支持邮箱注册登录
- [ ] 用户可查看历史生成记录（最近20条）
- [ ] 支持模型收藏功能
- [ ] 每个用户最多存储50个模型

#### 2.3.2 模型编辑功能（基础）
**功能描述：**
- 简单的缩放、旋转、平移
- 添加文字或简单图案
- 模型修复（填补破洞）

**技术实现方案：**
- Three.js编辑器功能
- 使用trimesh进行模型修复
- 可选：集成Blender Python API

**验收标准：**
- [ ] 支持XYZ三轴独立缩放
- [ ] 支持90度旋转
- [ ] 可添加文字（支持中英文）
- [ ] 自动修复破面

---

### 2.4 P4 功能模块（未来扩展）

#### 2.4.1 高级AI模型优化
- 多视角照片重建
- 高精度纹理贴图
- AI自动修复模型缺陷

#### 2.4.2 社区功能
- 模型分享和下载
- 用户作品展示
- 评论和点赞系统

#### 2.4.3 打印服务对接
- 对接在线打印服务商
- 在线下单和配送
- 价格估算

#### 2.4.4 高级风格化
- 自定义风格训练
- 多种艺术风格转换
- 风格混合

---

## 3. 技术架构

### 3.1 前端技术栈
- **框架**：React 18+
- **3D渲染**：Three.js / React Three Fiber
- **UI组件**：Tailwind CSS + Headless UI
- **状态管理**：Zustand（轻量级）
- **文件上传**：React Dropzone

### 3.2 后端技术栈
- **框架**：Python FastAPI
- **AI模型推理**：PyTorch
- **3D处理**：trimesh, open3d
- **异步任务**：Celery + Redis
- **API文档**：OpenAPI (FastAPI自动生成)

### 3.3 AI模型选型
- **文本转3D**：meshy.ai API
- **照片转3D**：meshy.ai API
- **风格化**：AnimeGANv3 或 CartoonGAN

### 3.4 版本兼容性要求

#### 3.4.1 后端环境
- **Python**: 3.10+ （推荐使用 Python 3.11 或 3.12）
  - PyTorch 要求最低 Python 3.10
  - FastAPI 支持 Python 3.8-3.14
  - trimesh 支持 Python 3.8-3.12
  - open3d 支持 Python 3.8-3.12
  - Celery 支持 Python 3.8-3.13
  - **选择 Python 3.10-3.12 可确保所有库兼容**

#### 3.4.2 核心依赖版本
- **FastAPI**: 0.115+ （支持 Python 3.8+）
- **PyTorch**: 2.5+ （要求 Python 3.10+）
- **trimesh**: 4.5+ （支持 Python 3.8-3.12）
- **open3d**: 0.18+ （支持 Python 3.8-3.12）
- **Celery**: 5.5+ （支持 Python 3.8-3.13）
- **Redis**: 7.0+（作为 Celery broker）

#### 3.4.3 前端环境
- **Node.js**: 18+ LTS 或 20+ LTS
- **React**: 18.3+
- **Three.js**: r160+
- **Tailwind CSS**: 3.4+

#### 3.4.4 第三方服务
- **meshy.ai API**: 需要注册获取 API Key
- **CuraEngine**: 5.x（用于 G-code 生成）

### 3.5 部署架构
- **MVP阶段**：Docker Compose单机部署
- **扩展阶段**：Kubernetes + GPU节点
- **存储**：本地文件系统 → 对象存储（MinIO/S3）

---

## 4. 风险与应对

### 4.1 技术风险
| 风险项 | 影响 | 概率 | 应对措施 |
|--------|------|------|----------|
| AI模型效果不达预期 | 高 | 中 | 提前测试多个开源模型，准备备选方案（第三方API） |
| GPU资源不足 | 中 | 高 | MVP阶段使用CPU推理（虽慢但可用），后期考虑云GPU |
| 模型文件过大导致传输慢 | 中 | 中 | 实现文件压缩，限制模型复杂度 |
| 切片软件集成困难 | 低 | 中 | 优先支持单一机型（拓竹H2D），降低兼容性复杂度 |

### 4.2 时间风险
- **依赖第三方API**：需要考虑API调用限制和成本
- **依赖库安装问题**：提前准备Docker镜像，包含所有依赖

---

## 5. 成功指标

### 5.1 P0阶段（MVP）
- [ ] 用户可成功输入文本并生成3D模型
- [ ] 生成成功率 > 80%
- [ ] 单次生成时间 < 60秒
- [ ] 导出的STL文件可被切片软件识别
- [ ] 生成的G-code可被拓竹H2D打印机识别并正常打印
- [ ] 系统无严重bug，可持续运行

### 5.2 P1阶段
- [ ] 照片转3D成功率 > 70%
- [ ] 风格化处理效果满意度 > 60%（小范围用户调研）
- [ ] 日均生成模型数 > 50个

### 5.3 P2阶段
- [ ] 注册用户数 > 500
- [ ] 用户留存率 > 30%（7天）
- [ ] 模型编辑功能使用率 > 40%

---

## 6. 附录

### 6.1 参考资源
- **Meshy.ai**: https://www.meshy.ai/
- **Three.js**: https://threejs.org/
- **CuraEngine**: https://github.com/Ultimaker/CuraEngine
- **trimesh**: https://github.com/mikedh/trimesh

### 6.2 竞品分析
- **Rodin**：视频转3D，技术先进但仍处于测试阶段
- **Thingiverse**：3D模型分享平台，无AI生成功能

### 6.3 未来扩展方向
- 多模态输入（文本+图片联合生成）
- AR预览功能（手机端）
- AI辅助的打印失败诊断
- 打印材料推荐系统

---

**文档版本**: v1.0
**创建日期**: 2025-10-24
**最后更新**: 2025-10-24
**负责人**: AI Assistant
**审核人**: 待定
